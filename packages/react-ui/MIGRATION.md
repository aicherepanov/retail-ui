# Migration

- [1.x - 2.0]()
  - [Именованные экспорты, ES6 модули и tree-shaking]()
  - [Изменена сигнатура `onChange`]()
  - [Отдельный пакет для Контур-специфичных компонентов]()
  - [Использование нативного ReactContext для `Theme(Locale-)Provider`]()
  - [Встроены иконки из `@skbkontur/react-icons`]()
  - [Удален устаревший код]()
    - [`Lookup.js` и адаптеры для компонентов]()
    - [Flow типизация]()
    - [Устаревшие компоненты и свойства]()
- [0.x - 1.0]()
  - [Переход с кастомизации с помощью `less`]()

## 1.x - 2.0

### Именованные экспорты, ES6 модули и tree-shaking

Начиная с 2.0 исходный код библиотеки распространяются в виде ES6 модулей. Это необходимо для обеспечения правильной работы
tree-shaking.

Кроме этого все публичные компоненты библиотеки доступны в виде именованных импортов из корня:
`import { Button } from '@skbkontur/react-ui;`

Если вы каким-либо образом загружаете компоненты библиотеки в nodejs, например в unit тестах. Вам необходимо добавить в
пути для трансформации путь до `@skbkontur/react-ui`, чтобы избежать ошибки
`Error [ERR_REQUIRE_ESM]: Must use import to load ES Module` или `SyntaxError: Cannot use import statement outside a module`.
При этом для сборки бандла в webpack конфиге ничего дополнительно настраивать не нужно.

Публичными компонентами называются те для которых есть страница с документацией на [витрине компонентов](https://tech.skbkontur.ru/react-ui/)
Компоненты, которые отсутствуют на витрине считаются внутренними и не рекомендуются к использованию, так как для них не
гарантируется сохранение обратной совместимости в рамках одной мажорной версии. Но если по каким-то причинам вам всё же
необходимо использовать внутренний компонент, импортировать его можно из `@skbkontur/react-ui/internal/<ComponentName>`.

Для облегчения перевода проекта можно воспользоваться [codemod `transformImportsAndExports`]()

### Изменена сигнатура `onChange`

В 2.0 добавлено новое свойство `onValueChange`. Которое пришло на замену или в дополнение к существующему свойству `onChange`.

В компонентах в которых есть возможность получить нативное событие `change`
(`Autocomplete/Checkbox/Radio/Textarea/Toggle/Input/CurrencyInput/FxInput/PasswordInput`) свойство `onChange` полностью
повторяет сигнатуру нативных HTML элементов.

Для компонентов в которых отсутствует нативное событие `change` свойство `onChange` было удалено.

Сделано это было для уменьшения неоднозначности `onChange` у разных компонентов, а так же для облегчения использования
компонентов с `Hooks API`

```jsx
const [name, setName] = useState('');

<Input value={name} onValueChange={setName} />;
```

Мы подготовили [codemod `transformOnChange`]() для перехода на новое API компонентов, но в виду множества вариантов
использования свойств компонентов codemod покрывает только несколько достаточно очевидных сценариев, в тех местах где
нельзя автоматически преобразовать `onChange` в `onValueChange` будет выводится сообщение. Codemod должен применятся
исключительно после применения `transformImportsAndExports`, в ином случае корректный результат не гарантируется.

### Отдельный пакет для Контур-специфичных компонентов

Библиотека позиционируется как open-source, в том числе с возможностью использовать компоненты вне Контура. Поэтому все
компоненты использующие фирменный стиль или api сервисов Контура с выпуском 2.0 переезжают в отдельный репозиторий [ссылка]()
и npm пакет в nexus (название)[]

**Как переехать**

При этом, если у вас нет возможности настроить nexus прямо сейчас, компоненты остаются в составе библиотеки до 3.0

### Использование нативного ReactContext для `Theme(Locale-)Provider`

### Встроены иконки из `@skbkontur/react-icons`

### Удален устаревший код

#### `Lookup.js` и адаптеры для компонентов

#### Flow типизация

#### Устаревшие компоненты и свойства

## 0.x - 1.0

### Переход с кастомизации с помощью `less`
